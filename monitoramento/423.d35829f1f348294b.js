"use strict";(self.webpackChunkMonitoramento=self.webpackChunkMonitoramento||[]).push([[423],{423:(ye,b,i)=>{i.r(b),i.d(b,{SitesModule:()=>ve});var p=i(433),g=i(6895),u=i(6811),m=i(9808),d=i(2728),w=i(7377);class Z extends w._{constructor(s){return super(),this.url="",this.site_Group_Id=void 0,s}}var I=[{field:"id",header:"Id",maskType:d.O.undefined,filterType:d.vA.text,filterDisplay:d.w2.menu,filterShowMatchMode:!1,filterShowAddButton:!1},{field:"name",header:"Name",maskType:d.O.undefined,filterType:d.vA.text,filterDisplay:d.w2.menu,filterShowMatchMode:!1,filterShowAddButton:!1},{field:"url",header:"Url",maskType:d.O.undefined,filterType:d.vA.text,filterDisplay:d.w2.menu,filterShowMatchMode:!1,filterShowAddButton:!1},{field:"environment",header:"Environment",maskType:d.O.undefined,filterType:d.vA.text,filterDisplay:d.w2.menu,filterShowMatchMode:!1,filterShowAddButton:!1},{field:"group",header:"Group",maskType:d.O.undefined,filterType:d.vA.text,filterDisplay:d.w2.menu,filterShowMatchMode:!1,filterShowAddButton:!1}],x=i(3721),_=i(2687),e=i(4650),C=i(7549),M=i(7185),Y=i(9535),O=i(2340),j=i(1135),A=i(4004),D=i(529),Q=i(46);let f=(()=>{class t{constructor(n,o){this.http=n,this.table=o,this.api=O.N.url,this.list=new j.X([])}getList(){return this.table.loading.next(!0),this.http.get(this.api+"/Site/").pipe((0,A.U)(n=>(this.list.next(n),this.table.loading.next(!1),n)))}get(n){return this.http.get(`${this.api}/Site/${n}`).pipe((0,A.U)(o=>new Z(o)))}send(n){return this.http.post(`${this.api}/Site/`,n)}delete(n){return this.http.delete(`${this.api}/Site/${n}`)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(D.eN),e.LFG(Q.i))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var y=i(9243),G=i(3972),F=i(3446),q=i(8629),E=i(6201),L=i(898),v=i(8783),B=i(805);function H(t,s){1&t&&(e._UZ(0,"img",48),e.TgZ(1,"span"),e._uU(2,"Details"),e.qZA())}function K(t,s){1&t&&(e.TgZ(0,"p",12),e._uU(1,"This field is required."),e.qZA())}function P(t,s){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,K,2,0,"p",49),e.qZA()),2&t){e.oxw();const n=e.MAs(15);e.xp6(1),e.Q6J("ngIf",n.errors.required)}}function R(t,s){if(1&t&&(e.TgZ(0,"option",20),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("ngValue",n.id),e.xp6(1),e.Oqu(n.name)}}function V(t,s){1&t&&(e.TgZ(0,"p",12),e._uU(1,"This field is required."),e.qZA())}function W(t,s){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,V,2,0,"p",49),e.qZA()),2&t){e.oxw();const n=e.MAs(23);e.xp6(1),e.Q6J("ngIf",n.errors.required)}}function $(t,s){1&t&&(e.TgZ(0,"p",12),e._uU(1,"This field is required."),e.qZA())}function z(t,s){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,$,2,0,"p",49),e.qZA()),2&t){e.oxw();const n=e.MAs(41);e.xp6(1),e.Q6J("ngIf",n.errors.required)}}function X(t,s){1&t&&(e._UZ(0,"img",50),e.TgZ(1,"span"),e._uU(2,"Depends On"),e.qZA())}function k(t,s){1&t&&(e._UZ(0,"img",51),e.TgZ(1,"span"),e._uU(2,"Dependents"),e.qZA())}function ee(t,s){1&t&&(e._UZ(0,"img",52),e.TgZ(1,"span"),e._uU(2,"Body Guards"),e.qZA())}function te(t,s){if(1&t&&(e.TgZ(0,"p",12),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(n)}}function ne(t,s){1&t&&(e.TgZ(0,"p",12),e._uU(1,"Fill all required fields correctly to save"),e.qZA())}function oe(t,s){if(1&t&&(e.TgZ(0,"div",53),e.YNc(1,te,2,1,"p",54),e.YNc(2,ne,2,0,"p",49),e.qZA()),2&t){e.oxw();const n=e.MAs(1),o=e.oxw();e.xp6(1),e.Q6J("ngForOf",o.erro),e.xp6(1),e.Q6J("ngIf",n.invalid&&0==o.erro.length)}}function se(t,s){1&t&&e._UZ(0,"span",55)}function ie(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(n);const r=e.MAs(1),l=e.oxw();return e.KtG(l.send(r))}),e.TgZ(2,"div",4),e._UZ(3,"span",5),e.TgZ(4,"p-tabView",6),e.NdJ("activeIndexChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.tabChanged(r))}),e.TgZ(5,"p-tabPanel"),e.YNc(6,H,3,0,"ng-template",7),e.TgZ(7,"div",8)(8,"div",9)(9,"div",10)(10,"label",11),e._uU(11,"Name: "),e.TgZ(12,"span",12),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"input",13,14),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.name=r)}),e.qZA(),e.YNc(16,P,2,1,"div",15),e.qZA(),e.TgZ(17,"div",16)(18,"label",17),e._uU(19,"Environment: "),e.TgZ(20,"span",12),e._uU(21,"*"),e.qZA()(),e.TgZ(22,"select",18,19),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.environment_Id=r)}),e.TgZ(24,"option",20),e._uU(25,"Select"),e.qZA(),e.YNc(26,R,2,2,"option",21),e.qZA(),e.YNc(27,W,2,1,"div",15),e.qZA(),e.TgZ(28,"div",22)(29,"label",23),e._uU(30,"Test Interval (minutes): "),e.TgZ(31,"span",12),e._uU(32,"*"),e.qZA()(),e.TgZ(33,"app-input-number",24),e.NdJ("valueChanges",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.test_Interval_Minutes=r)}),e.qZA()()(),e.TgZ(34,"div",9)(35,"div",25)(36,"label",26),e._uU(37,"Url: "),e.TgZ(38,"span",12),e._uU(39,"*"),e.qZA()(),e.TgZ(40,"input",27,28),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.url=r)}),e.qZA(),e.YNc(42,z,2,1,"div",15),e.qZA(),e.TgZ(43,"div",29)(44,"label",30),e._uU(45,"Group: "),e.TgZ(46,"span",12),e._uU(47,"*"),e.qZA()(),e.TgZ(48,"app-p-dropdown-actions",31),e.NdJ("valueChanges",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.site_Group_Id=r)}),e.qZA()()(),e.TgZ(49,"div",9)(50,"div",32)(51,"label",33),e._uU(52,"Report To:"),e.qZA(),e.TgZ(53,"textarea",34,35),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.report_To=r)}),e.qZA()()(),e.TgZ(55,"div",9)(56,"div",36)(57,"div",37)(58,"input",38,39),e.NdJ("ngModelChange",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.active_Monitoring=r)}),e.qZA(),e.TgZ(60,"label",40),e._uU(61,"Active Monitoring"),e.qZA()()()()()(),e.TgZ(62,"p-tabPanel"),e.YNc(63,X,3,0,"ng-template",7),e.TgZ(64,"app-picklist-dependents",41),e.NdJ("valueChanges",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.depends_On=r)}),e.qZA()(),e.TgZ(65,"p-tabPanel"),e.YNc(66,k,3,0,"ng-template",7),e.TgZ(67,"app-picklist-dependents",42),e.NdJ("valueChanges",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.dependents=r)}),e.qZA()(),e.TgZ(68,"p-tabPanel"),e.YNc(69,ee,3,0,"ng-template",7),e.TgZ(70,"app-picklist-dependents",43),e.NdJ("valueChanges",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.object.bodyguards_Monitoring=r)}),e.qZA()()()(),e.TgZ(71,"div",44),e.YNc(72,oe,3,2,"div",45),e.TgZ(73,"button",46),e.YNc(74,se,1,0,"span",47),e.TgZ(75,"span"),e._uU(76,"Save"),e.qZA()()()()}if(2&t){const n=e.MAs(1),o=e.MAs(15),r=e.MAs(23),l=e.MAs(41),a=e.oxw();e.xp6(14),e.Q6J("ngModel",a.object.name),e.xp6(2),e.Q6J("ngIf",o.touched&&o.errors),e.xp6(6),e.Q6J("ngModel",a.object.environment_Id),e.xp6(2),e.Q6J("ngValue",void 0),e.xp6(2),e.Q6J("ngForOf",a.listEnvironments),e.xp6(1),e.Q6J("ngIf",r.touched&&r.errors),e.xp6(6),e.Q6J("inputId","test_Interval_Minutes")("required",!0)("arrowControls",!0)("value",a.object.test_Interval_Minutes),e.xp6(7),e.Q6J("ngModel",a.object.url),e.xp6(2),e.Q6J("ngIf",l.touched&&l.errors),e.xp6(6),e.Q6J("options",a.listSiteGroup)("value",a.object.site_Group_Id)("path","sites-group")("required",!0),e.xp6(5),e.Q6J("ngModel",a.object.report_To),e.xp6(5),e.Q6J("ngModel",a.object.active_Monitoring),e.xp6(6),e.Q6J("list",a.listNoDependsOn)("selected",a.object.depends_On),e.xp6(3),e.Q6J("list",a.listNoDependents)("selected",a.object.dependents),e.xp6(3),e.Q6J("list",a.listBodyguard)("selected",a.object.bodyguards_Monitoring),e.xp6(2),e.Q6J("ngIf",a.erro||n.invalid),e.xp6(1),e.Q6J("disabled",n.invalid||a.loading),e.xp6(1),e.Q6J("ngIf",a.loading)}}let S=(()=>{class t{constructor(n,o,r,l,a,h,T,Te){this.modal=n,this.toastr=o,this.dropdown=r,this.siteService=l,this.activatedRoute=a,this.crypto=h,this.loadingUtils=T,this.router=Te,this.faTrash=_.$aW,this.faEdit=_.Xcf,this.faPlus=_.r8p,this.object=new Z({}),this.erro=[],this.loading=!1,this.isEditPage=!1,this.title="",this.success={true:"Opera\xe7\xe3o conclu\xedda com sucesso!",false:"Algum erro foi encontrado. Processo interrompido"},this.listBodyguard=[],this.listEnvironments=[],this.listNoDependents=[],this.listNoDependsOn=[],this.listSiteGroup=[],this.subscribers=[];var be=this.loadingUtils.loading.subscribe(c=>this.loading=c);this.subscribers.push(be),this.activatedRoute.params.subscribe(c=>{c.site_id?((0,m.n)(this.dropdown.getBodyGuardList(this.object.id)),(0,m.n)(this.dropdown.getResourceNoDependsOn(this.object.id)),(0,m.n)(this.dropdown.getResourceNoDependent(this.object.id)),this.idEncrypted=c.site_id,this.isEditPage=!0,this.title="Edit site",this.object.id=this.crypto.decrypt(this.idEncrypted),(0,m.n)(this.siteService.get(this.object.id)).then(U=>{this.object=U,setTimeout(()=>{this.modal.setOpen(!0)},100)}).catch(U=>{this.modal.voltar(),this.toastr.error("This page could not be accessed")})):(this.isEditPage=!1,this.title="Create site",setTimeout(()=>{this.modal.setOpen(!0)},100))});var Ze=this.dropdown.bodyguards.subscribe(c=>this.listBodyguard=c);this.subscribers.push(Ze);var xe=this.dropdown.resourceEnvironments.subscribe(c=>this.listEnvironments=c);this.subscribers.push(xe);var Ce=this.dropdown.resourceNoDependents.subscribe(c=>this.listNoDependents=c);this.subscribers.push(Ce);var Me=this.dropdown.resourceNoDependsOn.subscribe(c=>this.listNoDependsOn=c);this.subscribers.push(Me);var Ae=this.dropdown.siteGroup.subscribe(c=>this.listSiteGroup=c);this.subscribers.push(Ae)}ngOnInit(){}ngOnDestroy(){this.subscribers.forEach(n=>n.unsubscribe())}ngAfterViewInit(){(0,x.Z)(0)}tabChanged(n){(0,x.Z)(n)}send(n){if(n.invalid)return this.toastr.error("There are one or more invalid fields."),void(this.erro=["There are one or more invalid fields."]);this.erro=[],(0,m.n)(this.siteService.send(this.object)).then(o=>{o.success?(this.toastr.success(this.success.true),this.modal.voltar(),(0,m.n)(this.siteService.getList())):(this.toastr.error(this.success.false),this.erro.push(o.message))}).catch(o=>{this.erro.push(o.message)})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(C.Q),e.Y36(M._W),e.Y36(Y.V),e.Y36(f),e.Y36(u.gz),e.Y36(y.w),e.Y36(G.b),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-form"]],decls:4,vars:2,consts:[["form",""],[3,"title","template"],[3,"ngSubmit"],["form","ngForm"],[1,"form-tabs"],[1,"form-tabs-bg"],[3,"activeIndexChange"],["pTemplate","header"],[1,"px-4"],[1,"row"],[1,"form-group","col-lg-6","col-md-4","col-sm-5","col-12"],["for","name"],[1,"text-danger"],["type","text","id","name","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngIf"],[1,"form-group","col-lg-3","col-md-4","col-sm-5","col-12"],["for","environment_Id"],["id","environment_Id","name","environment_Id","required","",1,"form-control",3,"ngModel","ngModelChange"],["environment_Id","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-group","col-lg-3","col-md-4","col-sm-2","col-12"],["for","test_Interval_Minutes"],[3,"inputId","required","arrowControls","value","valueChanges"],[1,"form-group","col-lg-8","col-md-12","col-sm-12","col-12"],["for","url"],["type","url","id","url","name","url","required","",1,"form-control",3,"ngModel","ngModelChange"],["url","ngModel"],[1,"form-group","col-lg-4","col-md-6","col-sm-6","col-12"],["for","site_Group_Id"],[3,"options","value","path","required","valueChanges"],[1,"form-group","col-lg-12","col-md-12","col-sm-12","col-12"],["for","text"],["id","report_To","name","report_To",1,"form-control",3,"ngModel","ngModelChange"],["report_To","ngModel"],[1,"form-group","mt-2"],[1,"d-flex","align-items-center"],["type","checkbox","name","active_Monitoring","id","active_Monitoring",1,"me-2",3,"ngModel","ngModelChange"],["active_Monitoring","ngModel"],["for","active_Monitoring",1,"mb-0"],["title","Depends On",3,"list","selected","valueChanges"],["title","Dependents",3,"list","selected","valueChanges"],["title","Body Guards",3,"list","selected","valueChanges"],[1,"d-flex","align-items-center","p-0","mt-1"],["class","m-0",4,"ngIf"],[1,"btn","btn-primary","mr-0","ms-auto",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["src","./../../../../assets/img/icons/icon-infos.png","alt",""],["class","text-danger",4,"ngIf"],["src","./../../../../assets/img/icons/icon-dependson.png"],["src","./../../../../assets/img/icons/icon-dependents.png"],["src","./../../../../assets/img/icons/icon-monitoring.png"],[1,"m-0"],["class","text-danger",4,"ngFor","ngForOf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(n,o){if(1&n&&(e.YNc(0,ie,77,27,"ng-template",null,0,e.W1O),e._UZ(2,"app-modal",1)(3,"router-outlet")),2&n){const r=e.MAs(1);e.xp6(2),e.Q6J("title",o.title)("template",r)}},dependencies:[g.sg,g.O5,u.lC,F.z,q.Z,E.Y,L.l,p._Y,p.YN,p.Kr,p.Fj,p.Wl,p.EJ,p.JJ,p.JL,p.Q7,p.On,p.F,v.xf,v.x4,B.jx]}),t})();function re(t,s){if(1&t&&(e.TgZ(0,"p",9),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(n)}}function le(t,s){1&t&&e._UZ(0,"span",10)}function ae(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.send())}),e.TgZ(2,"div")(3,"div")(4,"p"),e._uU(5,"Are you sure you want to delete?"),e.qZA(),e.TgZ(6,"p",4),e._uU(7,"All monitoring history for this resource will be erased."),e.qZA(),e.TgZ(8,"p",4),e._uU(9,"This operation is not reversible. You can also just disable monitoring for this feature, rather than deleting it."),e.qZA(),e.TgZ(10,"p",4),e._uU(11,"Are you sure you want to proceed with the deletion?"),e.qZA(),e.YNc(12,re,2,1,"p",5),e.qZA(),e.TgZ(13,"div",6)(14,"button",7),e.YNc(15,le,1,0,"span",8),e.TgZ(16,"span"),e._uU(17,"Delete"),e.qZA()()()()()}if(2&t){const n=e.MAs(1),o=e.oxw();e.xp6(12),e.Q6J("ngForOf",o.erro),e.xp6(2),e.Q6J("disabled",n.invalid||o.loading),e.xp6(1),e.Q6J("ngIf",o.loading)}}let pe=(()=>{class t{constructor(n,o,r,l,a){this.modal=n,this.siteService=o,this.toastr=r,this.crypto=l,this.activatedRoute=a,this.title="Delete site",this.id=0,this.idEncrypted="",this.erro=[],this.loading=!1,this.success={true:"Opera\xe7\xe3o conclu\xedda com sucesso!",false:"Algum erro foi encontrado. Processo interrompido"},this.activatedRoute.params.subscribe(h=>{h.site_id?(this.idEncrypted=h.site_id,this.id=this.crypto.decrypt(this.idEncrypted),(0,m.n)(this.siteService.get(this.id)).then(T=>{setTimeout(()=>{this.modal.setOpen(!0)},100)}).catch(T=>{this.modal.voltar()})):this.modal.voltar()})}send(){this.erro=[],(0,m.n)(this.siteService.delete(this.id)).then(n=>{console.log(n),n.success?this.toastr.success(this.success.true):this.toastr.error(this.success.false),this.modal.voltar(),(0,m.n)(this.siteService.getList())}).catch(n=>{console.error(n),this.toastr.error(n.message),this.erro.push(n.message)}).finally(()=>{this.loading=!1})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(C.Q),e.Y36(f),e.Y36(M._W),e.Y36(y.w),e.Y36(u.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-delete"]],decls:4,vars:3,consts:[["form",""],[3,"title","template","maxWidth"],[3,"ngSubmit"],["form","ngForm"],[1,"text-info","mt-2"],["class","text-danger mt-2","style","word-wrap: break-word;",4,"ngFor","ngForOf"],[1,"d-flex","just","p-0","mt-3"],[1,"btn","btn-primary","mr-0","ms-auto",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"text-danger","mt-2",2,"word-wrap","break-word"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(n,o){if(1&n&&(e.YNc(0,ae,18,3,"ng-template",null,0,e.W1O),e._UZ(2,"app-modal",1)(3,"router-outlet")),2&n){const r=e.MAs(1);e.xp6(2),e.Q6J("title",o.title)("template",r)("maxWidth","510px")}},dependencies:[g.sg,g.O5,u.lC,F.z,p._Y,p.JL,p.F]}),t})();var de=i(6912);const ce=function(){return["create"]},N=()=>Promise.all([i.e(592),i.e(780)]).then(i.bind(i,5780)).then(t=>t.SitesGroupModule),ue=[{path:"",component:(()=>{class t{constructor(n){this.siteService=n,this.list=[],this.columns=I,this.tableLinks=[],this.subscribers=[],this.tableLinks=[{label:"Edit",routePath:["edit"],paramsFieldName:["id"]},{label:"Delete",routePath:["delete"],paramsFieldName:["id"]}],this.siteService.list.subscribe(o=>this.list=o),(0,m.n)(this.siteService.getList())}ngOnDestroy(){this.subscribers.forEach(n=>n.unsubscribe())}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-list"]],decls:10,vars:10,consts:[[1,"page"],[1,"page__header"],[1,"page__header-icon"],["src","./../../../../assets/img/icons/sites.svg"],[1,"me-auto"],[1,"page__header-title"],[1,"page__body"],[3,"list","createLink","paginator","filterTable","sortable","columns","selectable","selectionMode","tableLinks"]],template:function(n,o){1&n&&(e.TgZ(0,"section",0)(1,"div",1)(2,"span",2),e._UZ(3,"img",3),e.qZA(),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6,"Sites"),e.qZA()()(),e.TgZ(7,"div",6),e._UZ(8,"app-table",7),e.qZA()(),e._UZ(9,"router-outlet")),2&n&&(e.xp6(8),e.Q6J("list",o.list)("createLink",e.DdM(9,ce))("paginator",!0)("filterTable",!0)("sortable",!0)("columns",o.columns)("selectable",!0)("selectionMode","single")("tableLinks",o.tableLinks))},dependencies:[u.lC,de.v]}),t})(),children:[{path:"create",component:S,children:[{path:"sites-group",loadChildren:N}]},{path:"edit/:site_id",component:S,children:[{path:"sites-group",loadChildren:N}]},{path:"delete/:site_id",component:pe}]}];let ge=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(ue),u.Bz]}),t})();var J=i(1094),he=i(4466),_e=i(2216),fe=i(666);let ve=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.ez,ge,J.yI,he.m,_e.uH,p.u5,J.yI.forChild(),v.LU,fe.kW]}),t})()}}]);